<%- include('includes/header') %>
<!-- header ends here -->

<div class="container py-md-5 container--narrow">
  <%- include('includes/flash') %>

  <form id="createPost" action="/post/<%= post._id %> /edit" method="POST">
    <div class="form-group">
      <label for="post-title" class="text-muted mb-1"><small>Title</small></label>
      <input
        value="<%= post.title %>"
        required
        name="title"
        id="post-title"
        class="form-control form-control-lg form-control-title"
        type="text"
        placeholder=""
        autocomplete="off"
      />
    </div>

    <div class="form-group">
      <label for="post-body" class="text-muted mb-1"><small>Body Content</small></label>
      <div id="editor"></div>
      <input id="post-body" type="hidden" name="body" />
      <!-- <textarea
        required
        name="body"
        id="post-body"
        class="body-content tall-textarea form-control"
        type="text"
      ></textarea> -->
    </div>

    <button class="btn btn-primary">Save Updates</button>
  </form>
</div>

<!-- footer begins -->
<script src="/@ckeditor/ckeditor5-build-classic/build/ckeditor.js"></script>
<script>
  ClassicEditor.create(document.querySelector('#editor'), { initialData: '<%- post.body %>' })
    .then(editor => {
      window.editor = editor
      document.querySelector('.ck-editor__main p').style.height = '400px'
      const form = document.getElementById('createPost')
      form.addEventListener('submit', e => {
        e.preventDefault()
        document.getElementById('post-body').value = editor.getData()
        form.submit()
      })
    })
    .catch(error => {
      console.error('There was a problem initializing the editor.', error)
    })
</script>
<%- include('includes/footer') %>
